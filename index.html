<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Gray Truth of Sunny SoCal | 2023 Analysis</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:wght@400;700&display=swap"
        rel="stylesheet">
    <!-- CSS -->
    <link rel="stylesheet" href="css/style.css">
    <!-- Mapbox -->
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css' rel='stylesheet' />
</head>

<body>

    <!-- SECTION 1: HERO -->
    <section class="hero">
        <div id="hero-grid-bg"></div>
        <canvas id="fog-overlay"></canvas>
        <div class="hero-content">
            <div class="title-wrapper">
                <h1 class="hero-title">The Gray Truth of Sunny SoCal</h1>
            </div>
            <p class="hero-subtitle">Visualizing 365 days of cloud cover in 2023.</p>
            <p class="interaction-hint">Move your cursor to clear the morning fog</p>
        </div>
        <div class="scroll-prompt">Scroll for Analysis</div>
    </section>

    <!-- INTRO -->
    <section class="intro">
        <p>Southern California is sold to the world as a paradise of perpetual blue skies. But for the 20 million
            residents living here, the reality is often grayer, gloomier, and more complex. We analyzed satellite
            imagery from every morning in 2023 to map the true patterns of the marine layer.</p>
    </section>

    <!-- SECTION 2: CLOUD WALL (SCROLLYTELLING) -->
    <section id="cloud-wall-section" class="scrolly-container">
        <div class="sticky-viz">
            <div class="viz-header">
                <h2>2023 Cloud Calendar</h2>
                <p style="font-size: 0.9rem; color: #666; margin-bottom: 0.5rem;">Hover any day to see the satellite
                    view. Toggle modes below to compare times.</p>
                <div class="viz-controls">
                    <button class="viz-btn" data-mode="morning"
                        onclick="app.cloudWall.setView('morning')">Morning</button>
                    <button class="viz-btn" data-mode="afternoon"
                        onclick="app.cloudWall.setView('afternoon')">Afternoon</button>
                    <button class="viz-btn active" data-mode="both" onclick="app.cloudWall.setView('both')">Compare
                        Both</button>
                </div>
                <div class="viz-legend" style="margin-top:10px;">
                    <span>Clear</span>
                    <div class="gradient-bar"></div>
                    <span>Overcast</span>
                </div>
            </div>
            <div id="cloud-cal-grid"></div>
        </div>

        <div class="scroll-steps">
            <!-- Step 1 -->
            <div class="step" data-step="1">
                <div class="step-content">
                    <h3>The Morning Baseline</h3>
                    <p>This is the view from space at 8:00 AM each day. Contrary to the stereotype, perfectly clear
                        mornings are rare anomalies, not the rule.</p>
                </div>
            </div>

            <!-- Step 2 -->
            <div class="step" data-step="2">
                <div class="step-content">
                    <h3>Winter Instability</h3>
                    <p>The year began with significant atmospheric instability. Jan through March 2023 saw historic
                        rainfall, reflected here in the dense, persistent cloud bands.</p>
                </div>
            </div>

            <!-- Step 3 -->
            <div class="step" data-step="3">
                <div class="step-content">
                    <h3>The "May Gray" Shift</h3>
                    <p>As spring stabilizes, a different pattern emerges. The marine layer begins to solidify, turning
                        the coast into a permanent bank of low-level stratus clouds.</p>
                </div>
            </div>

            <!-- Step 4 -->
            <div class="step" data-step="4">
                <div class="step-content">
                    <h3>Peak Gloom</h3>
                    <p>By June, the marine layer is at its strongest. For coastal residents, the sun is effectively
                        blocked for weeks at a time. This is the infamous "June Gloom."</p>
                </div>
            </div>

            <!-- Step 5 -->
            <div class="step" data-step="5">
                <div class="step-content">
                    <h3>The Afternoon Burn-off</h3>
                    <p>Changing the data view to <strong>2:00 PM</strong> reveals the defining rhythm of the region. The
                        marine layer is fragile; it evaporates as the land heats up, clearing the skies by
                        mid-afternoon.</p>
                </div>
            </div>

            <!-- Step 6 -->
            <div class="step" data-step="6">
                <div class="step-content">
                    <h3>Second Summer</h3>
                    <p>True summer arrives late. September and October bring the clearest, hottest days often referred
                        to as "Second Summer," as the desert winds finally overpower the ocean air.</p>
                </div>
            </div>

            <!-- Step 7 -->
            <div class="step" data-step="7">
                <div class="step-content">
                    <h3>A Complex Rhythm</h3>
                    <p>The "Sunny SoCal" label is a simplification of this complex daily dance between ocean and desert.
                        To understand it, we must experience the variability day by day.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- BRIDGE 1 -->
    <section class="prose-bridge">
        <h2>The Daily Rhythm</h2>
        <p>While the annual calendar reveals the large-scale dominance of the marine layer, it obscures the day-to-day
            texture of the weather. A single week in May can oscillate between heavy drizzle and scorching heat
            depending on the strength of the onshore flow.</p>
        <p>To truly grasp the variability, we need to look closer. We've built an interactive archive of the 2023
            satellite record. You can scrub through the year below to observe the formation and dissipation of clouds
            for yourself.</p>
    </section>

    <!-- SECTION 3: CLOUD PLAYGROUND -->
    <section id="cloud-playground" class="full-screen-section">
        <div class="section-header">
            <h2>The Satellite Archive</h2>
            <p>Drag the scrubber to observe the daily cloud patterns across 2023.</p>
        </div>

        <!-- Master Timeline -->
        <div id="cp-timeline-container" style="width: 100%; max-width: 1200px; margin-bottom: 2rem;">
            <div class="timeline-label-row">
                <span>Jan</span><span>Feb</span><span>Mar</span><span>Apr</span><span>May</span><span>Jun</span>
                <span>Jul</span><span>Aug</span><span>Sep</span><span>Oct</span><span>Nov</span><span>Dec</span>
            </div>
            <div id="cp-master-timeline">
                <div class="timeline-cursor" id="cp-cursor"></div>
            </div>
        </div>

        <div class="cp-dashboard">
            <!-- Left: Preview -->
            <div class="cp-preview panel">
                <div class="cp-image-container">
                    <img id="cp-image" src="" alt="Satellite View">
                    <div class="cp-overlay-label">Satellite View</div>
                </div>
                <div class="cp-stats-row">
                    <div class="cp-stat-group">
                        <div id="cp-date-display" class="cp-stat-title">Jan 1, 2023</div>
                        <div id="cp-mood-display" class="cp-stat-value">Clear</div>
                    </div>
                    <div class="cp-meter-group">
                        <label>Cloud Fraction</label>
                        <div class="progress-bar">
                            <div id="cp-progress-fill" style="width: 0%"></div>
                        </div>
                        <span id="cp-progress-text">0%</span>
                    </div>
                </div>
            </div>

            <!-- Right: Controls -->
            <div class="cp-controls panel">
                <div class="tabs">
                    <button class="tab-btn active" data-mode="timeline"
                        onclick="app.playground.setMode('timeline')">Timeline</button>
                    <button class="tab-btn" data-mode="extremes"
                        onclick="app.playground.setMode('extremes')">Outliers</button>
                </div>

                <div id="view-timeline" class="control-view">
                    <div class="control-group">
                        <label>Observation Time</label>
                        <div class="time-toggles">
                            <button class="toggle-btn active" id="btn-morning"
                                onclick="app.playground.setTime('morning')">08:00 AM</button>
                            <button class="toggle-btn" id="btn-afternoon"
                                onclick="app.playground.setTime('afternoon')">02:00 PM</button>
                        </div>
                    </div>
                    <p class="helper-text" style="margin-top:1rem;">Notice how the yellow "clear" bars on the timeline
                        become sparse during May and June mornings.</p>
                </div>

                <div id="view-extremes" class="control-view hidden">
                    <p class="helper-text">Identify the statistical outliers of 2023.</p>
                    <button class="action-btn" onclick="app.playground.findExtreme('cloudiest')">Find Cloudiest
                        Day</button>
                    <button class="action-btn" onclick="app.playground.findExtreme('clearest')">Find Clearest
                        Afternoon</button>
                    <button class="action-btn secondary" onclick="app.playground.findExtreme('random')">Random
                        Sample</button>
                </div>
            </div>
        </div>
    </section>



    <!-- BRIDGE 2 -->
    <section class="prose-bridge">
        <h2>Quantifying the "Vibe"</h2>
        <p>Clouds are only one part of the equation. The "SoCal Vibe"—that specific feeling of warmth and light—is a
            composite of three variables: <em>Cloud Cover</em>, <em>Temperature</em>, and <em>Solar Radiation</em>.</p>
        <p>When we layer these datasets, we see that the peak of heat does not align with the peak of light. The "June
            Gloom" phenomenon creates a lag, pushing the "ideal" summer weather late into the calendar year.</p>
    </section>

    <!-- SECTION 4: CLIMATE LAB -->
    <section id="climate-lab" class="full-screen-section bg-light">
        <div class="section-header">
            <h2>The Seasonality Matrix</h2>
            <p>Comparing the seasonal phases of three key climate variables.</p>
        </div>

        <div class="lab-container panel">
            <!-- Viz -->
            <div class="lab-viz">
                <div id="lab-colorfield"></div>
            </div>

            <!-- Controls -->
            <div class="lab-controls">
                <h3>Variable Layer</h3>
                <div class="var-buttons">
                    <button class="var-btn active" onclick="app.lab.setVariable('clouds')">Cloud Cover</button>
                    <button class="var-btn" onclick="app.lab.setVariable('temp')">Temperature (Air)</button>
                    <button class="var-btn" onclick="app.lab.setVariable('sun')">Solar Radiation</button>
                </div>

                <div class="seasonality-chart">
                    <h3>Annual Trend</h3>
                    <div id="season-sparklines"></div>
                </div>

                <p id="lab-insight" class="lab-insight">
                    Data Insight: Cloud cover peaks in late spring, creating a disconnect with rising solar angles.
                </p>
            </div>
        </div>
    </section>

    <!-- BRIDGE 3 -->
    <section class="prose-bridge">
        <h2>Finding Your Spot</h2>
        <p>If the weather is this variable, where is the best place to live? The answer depends entirely on your
            personal definition of "Good Weather."</p>
        <p>Some avoid the heat at all costs and welcome the cooling marine layer. Others demand clear skies and tolerate
            the desert temperatures. We built a ranking model that adjusts to your personal preferences, re-ordering the
            region's cities based on their 2023 performance.</p>
    </section>

    <!-- SECTION 5: SUNNY CITY PLAYGROUND -->
    <section id="city-playground" class="full-screen-section bg-light">
        <!-- Map Visualization (Background) -->
        <div id="city-map-container"></div>

        <div class="city-dashboard">
            <!-- Floating Sidebar -->
            <div class="city-sidebar">
                <div class="sidebar-header" style="margin-bottom:1.5rem; text-align: left;">
                    <h2 style="font-size:1.5rem; margin-bottom:0.5rem;">The Location Optimizer</h2>
                    <p style="font-size:0.9rem; margin:0; color:#666;">Where should you live? Adjust weights to find
                        your match.</p>
                </div>

                <div class="city-filters panel">
                    <h3 style="font-size:0.85rem; color:#999; margin-bottom: 1rem;">Preference Weights</h3>

                    <div class="slider-group">
                        <label>Solar Importance <span id="val-sun">50</span></label>
                        <input type="range" min="0" max="100" value="50"
                            oninput="app.cities.updateWeight('sun', this.value)">
                    </div>

                    <div class="slider-group">
                        <label>Cloud Sensitivity <span id="val-cloud">70</span></label>
                        <input type="range" min="0" max="100" value="70"
                            oninput="app.cities.updateWeight('cloud', this.value)">
                    </div>

                    <div class="slider-group">
                        <label>Heat Aversion <span id="val-heat">30</span></label>
                        <input type="range" min="0" max="100" value="30"
                            oninput="app.cities.updateWeight('heat', this.value)">
                    </div>
                </div>

                <div class="city-leaderboard panel" style="margin-top: 1rem;">
                    <h3 style="font-size:0.85rem; color:#999; margin-bottom: 0.5rem;">Top Candidates</h3>
                    <div id="city-list">
                        <!-- JS Generated -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FOOTER -->
    <footer>
        <p>DSC 106 Final Project | Data Sources: GOES-16 Satellite Imagery, Local Weather Stations (2023)</p>
    </footer>

    <!-- LOGIC -->
    <script src="data/goes_images_index.js"></script>
    <script src="data/data.js"></script>
    <script src="js/app.js"></script>
</body>

</html>